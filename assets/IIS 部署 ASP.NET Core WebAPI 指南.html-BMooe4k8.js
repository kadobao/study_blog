import{_ as t}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as r,d as a,o}from"./app-DYrqe03T.js";const n={};function i(s,e){return o(),r("div",null,[...e[0]||(e[0]=[a('<h1 id="iis-部署-asp-net-core-web-api-指南" tabindex="-1"><a class="header-anchor" href="#iis-部署-asp-net-core-web-api-指南"><span>IIS 部署 <a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a> Core Web API 指南</span></a></h1><h2 id="第一步-安装必要组件" tabindex="-1"><a class="header-anchor" href="#第一步-安装必要组件"><span>第一步：安装必要组件</span></a></h2><h3 id="_1-1-下载-asp-net-core-托管捆绑包" tabindex="-1"><a class="header-anchor" href="#_1-1-下载-asp-net-core-托管捆绑包"><span>1.1 下载 <a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a> Core 托管捆绑包</span></a></h3><p>下载 Windows 版本的 <a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a> Core 托管捆绑包（Hosting Bundle），对应「<a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a> Core 运行时 8.0.22」板块下 Windows 行的「Hosting Bundle」链接：</p><p><strong>下载地址：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">https://builds.dotnet.microsoft.com/dotnet/aspnetcore/Runtime/8.0.22/dotnet-hosting-8.0.22-win.exe</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><blockquote><p>📝 <strong>说明</strong>：这个包含了 IIS 部署必须的组件</p></blockquote><h3 id="_1-2-启用-windows-功能" tabindex="-1"><a class="header-anchor" href="#_1-2-启用-windows-功能"><span>1.2 启用 Windows 功能</span></a></h3><p>确保已启用以下 Windows 功能：</p><ol><li>在 Windows 搜索框中搜索&quot;启用或关闭 Windows 功能&quot;并打开它</li><li>找到并展开&quot;Internet Information Services&quot;</li><li>全部勾选，然后点击确定</li></ol><h3 id="_1-3-安装-iis-模块" tabindex="-1"><a class="header-anchor" href="#_1-3-安装-iis-模块"><span>1.3 安装 IIS 模块</span></a></h3><p>需要安装以下 IIS 模块：</p><table><thead><tr><th>模块名称</th><th>下载链接</th></tr></thead><tbody><tr><td>URL Rewrite</td><td><a href="https://www.iis.net/downloads/microsoft/url-rewrite" target="_blank" rel="noopener noreferrer">点击下载</a></td></tr><tr><td>Application Request Routing</td><td><a href="https://www.iis.net/downloads/microsoft/application-request-routing" target="_blank" rel="noopener noreferrer">点击下载</a></td></tr></tbody></table><h2 id="第二步-发布-asp-net-core-web-api-项目" tabindex="-1"><a class="header-anchor" href="#第二步-发布-asp-net-core-web-api-项目"><span>第二步：发布 <a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a> Core Web API 项目</span></a></h2><p>先将 Visual Studio 中的 API 项目发布为「文件夹」形式（用于 IIS 读取）：</p><h3 id="_2-1-打开项目发布向导" tabindex="-1"><a class="header-anchor" href="#_2-1-打开项目发布向导"><span>2.1 打开项目发布向导</span></a></h3><ol><li>打开你的 <a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a> Core Web API 项目（确保已编译通过，无报错）</li><li>右键项目 → 选择「发布」（或顶部菜单：生成 → 发布）</li></ol><h3 id="_2-2-配置发布目标" tabindex="-1"><a class="header-anchor" href="#_2-2-配置发布目标"><span>2.2 配置发布目标</span></a></h3><p>在发布窗口中：</p><ol><li>点击「新建」→ 发布目标选择「文件夹」→ 点击「下一步」</li><li>选择目标框架（需与服务器安装的 .NET 运行时一致，如 .NET 8.0）→ 点击「下一步」</li><li>选择发布位置（建议本地创建一个容易找到的文件夹，如 <code>D:\\Publish\\MyWebApi</code>）→ 点击「完成」</li></ol><h3 id="_2-3-配置发布选项-关键" tabindex="-1"><a class="header-anchor" href="#_2-3-配置发布选项-关键"><span>2.3 配置发布选项（关键）</span></a></h3><p>在发布窗口的「配置」中，设置：</p><table><thead><tr><th>配置项</th><th>建议值</th><th>说明</th></tr></thead><tbody><tr><td>部署模式</td><td>框架依赖</td><td>需服务器安装对应 .NET 运行时，体积小</td></tr><tr><td>目标运行时</td><td>win-x64</td><td>Windows 64位系统</td></tr></tbody></table><p>点击「发布」按钮，等待发布完成（发布成功后会显示「发布成功」，并打开发布目录）</p><h2 id="第三步-配置发布目录权限-避免访问报错" tabindex="-1"><a class="header-anchor" href="#第三步-配置发布目录权限-避免访问报错"><span>第三步：配置发布目录权限（避免访问报错）</span></a></h2><ol><li>打开发布目录（如 <code>D:\\Publish\\MyWebApi</code>）</li><li>右键目录 → 选择「属性」→ 切换到「安全」选项卡</li><li>点击「编辑」→ 点击「添加」→ 输入对象名称 <code>IIS_IUSRS</code> → 点击「检查名称」→ 确认后点击「确定」</li><li>给「IIS_IUSRS」分配权限：勾选「读取」「读取和执行」「列出文件夹内容」→ 点击「确定」</li></ol><h2 id="第四步-配置-iis-核心步骤" tabindex="-1"><a class="header-anchor" href="#第四步-配置-iis-核心步骤"><span>第四步：配置 IIS（核心步骤）</span></a></h2><h3 id="_4-1-打开-iis-管理器" tabindex="-1"><a class="header-anchor" href="#_4-1-打开-iis-管理器"><span>4.1 打开 IIS 管理器</span></a></h3><p><strong>方法一：</strong></p><ol><li>按 <code>Win + R</code> → 输入 <code>inetmgr</code> → 回车</li></ol><p><strong>方法二：</strong><br> 控制面板 → 系统和安全 → 管理工具 → Internet Information Services (IIS) 管理器</p><h3 id="_4-2-创建应用程序池-必须为-asp-net-core-专用" tabindex="-1"><a class="header-anchor" href="#_4-2-创建应用程序池-必须为-asp-net-core-专用"><span>4.2 创建应用程序池（必须为 <a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a> Core 专用）</span></a></h3><blockquote><p>⚠️ <strong>重要</strong>：IIS 需要专用应用程序池运行 <a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a> Core，不能用默认池（默认池是为 <a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a> Framework 设计的）</p></blockquote><p>在 IIS 管理器左侧「连接」面板中：</p><ol><li>展开服务器名称 → 右键「应用程序池」→ 选择「添加应用程序池」</li></ol><p><strong>配置应用程序池：</strong></p><table><thead><tr><th>配置项</th><th>值</th><th>说明</th></tr></thead><tbody><tr><td>名称</td><td>自定义（如 <code>MyWebApiPool</code>）</td><td>便于识别</td></tr><tr><td>.NET CLR 版本</td><td>无托管代码</td><td><a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a> Core 不依赖 IIS 的 CLR 托管</td></tr><tr><td>托管管道模式</td><td>集成</td><td>-</td></tr></tbody></table><p>点击「确定」</p><h3 id="_4-3-创建网站-指向发布目录" tabindex="-1"><a class="header-anchor" href="#_4-3-创建网站-指向发布目录"><span>4.3 创建网站（指向发布目录）</span></a></h3><p>在 IIS 管理器左侧「连接」面板中，右键「网站」→ 选择「添加网站」</p><p><strong>配置网站基本信息：</strong></p><table><thead><tr><th>配置项</th><th>值</th><th>说明</th></tr></thead><tbody><tr><td>网站名称</td><td>自定义（如 <code>MyWebApi</code>）</td><td>与应用程序池名称一致便于管理</td></tr><tr><td>应用程序池</td><td>下拉选择第一步创建的应用程序池</td><td>必须匹配</td></tr><tr><td>物理路径</td><td>点击「浏览」→ 选择第一步发布的文件夹</td><td>如 <code>D:\\Publish\\MyWebApi</code></td></tr></tbody></table><p><strong>绑定：配置访问地址（关键）：</strong></p><table><thead><tr><th>配置项</th><th>建议值</th><th>说明</th></tr></thead><tbody><tr><td>类型</td><td>http</td><td>-</td></tr><tr><td>IP 地址</td><td>全部未分配</td><td>允许所有 IP 访问</td></tr><tr><td>端口</td><td>自定义未被占用的端口</td><td>如 <code>8080</code>，避免与默认 80 端口冲突</td></tr><tr><td>主机名</td><td>留空</td><td>无需域名时</td></tr></tbody></table><p>✅ 勾选「启动网站立即」</p><p>点击「确定」，此时网站会自动启动（左侧网站列表中状态为「已启动」）</p><h2 id="第五步-放行防火墙端口" tabindex="-1"><a class="header-anchor" href="#第五步-放行防火墙端口"><span>第五步：放行防火墙端口</span></a></h2><ol><li>控制面板 → 查看方式：大图标 → Windows Defender 防火墙</li><li>高级设置 → 入站规则 → 新建规则</li><li>选择「端口」→ 点击「下一步」</li><li>选择「TCP」→ 特定本地端口（如 <code>8080</code>）→ 点击「下一步」</li><li>选择「允许连接」→ 点击「下一步」</li><li>保持默认配置→ 点击「下一步」</li><li>输入规则名称（如 &quot;IIS Web API Port&quot;）→ 点击「完成」</li></ol><hr><p>✅ <strong>至此，<a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a> Core Web API 在 IIS 上的部署已完成！</strong></p><h2 id="iis-部署问题排查指南" tabindex="-1"><a class="header-anchor" href="#iis-部署问题排查指南"><span>IIS 部署问题排查指南</span></a></h2><h3 id="问题1-没有-web-config-报错-404" tabindex="-1"><a class="header-anchor" href="#问题1-没有-web-config-报错-404"><span>问题1：没有 web.config 报错 404</span></a></h3><p><strong>错误现象：</strong><br> 页面显示 404 错误（物理路径填写的是 VS 发布的路径）</p><p><strong>解决办法：</strong><br> 将 IIS 站点的物理路径修改为 VS 发布时实际填写的正确路径</p><h3 id="问题2-缺少-aspnetcoremodulev2-模块报错-500-19" tabindex="-1"><a class="header-anchor" href="#问题2-缺少-aspnetcoremodulev2-模块报错-500-19"><span>问题2：缺少 AspNetCoreModuleV2 模块报错 500.19</span></a></h3><p><strong>问题诊断步骤：</strong></p><ol><li>打开目标服务器的 IIS 管理器</li><li>点击左侧「服务器名称」（位于最顶部）</li><li>双击右侧「模块」（在「IIS」栏目下）</li><li>在模块列表中搜索「AspNetCoreModuleV2」</li></ol><p><strong>判断标准：</strong></p><ul><li>如果找不到该模块：说明模块未注册（这是核心问题）</li></ul><p><strong>解决办法：</strong></p><ol><li>卸载当前的 <code>dotnet-hosting-8.0.22-win.exe</code></li><li>重新安装 <code>dotnet-hosting-8.0.22-win.exe</code></li><li>以管理员身份打开命令提示符，执行命令：</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">iisreset</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="windows-server-服务器部署" tabindex="-1"><a class="header-anchor" href="#windows-server-服务器部署"><span>Windows Server 服务器部署</span></a></h2><h3 id="安装必要组件" tabindex="-1"><a class="header-anchor" href="#安装必要组件"><span>安装必要组件</span></a></h3><ol><li>打开「服务器管理器」</li><li>选择「添加角色和功能」</li><li>勾选「Web 服务器 (IIS)」，并确保勾选以下子项：</li></ol><p><strong>角色服务：</strong></p><ul><li><a href="http://ASP.NET" target="_blank" rel="noopener noreferrer">ASP.NET</a> 4.8</li><li>ISAPI 扩展</li><li>ISAPI 筛选器</li></ul><p><strong>管理工具：</strong></p><ul><li>IIS 管理器</li></ul><blockquote><p>📝 <strong>说明</strong>：之后的步骤按上面的常规部署流程进行即可。</p></blockquote>',70)])])}const h=t(n,[["render",i]]),p=JSON.parse('{"path":"/acrticle/%E4%B8%80%E4%BA%9B%E9%9A%8F%E8%AE%B0/IIS%20%E9%83%A8%E7%BD%B2%20ASP.NET%20Core%20WebAPI%20%E6%8C%87%E5%8D%97.html","title":"IIS 部署 ASP.NET Core WebAPI 指南","lang":"zh-CN","frontmatter":{"title":"IIS 部署 ASP.NET Core WebAPI 指南","icon":null,"order":35,"category":["一些随记"],"tag":["IIS","WebAPI"],"description":"IIS 部署 ASP.NET Core Web API 指南 第一步：安装必要组件 1.1 下载 ASP.NET Core 托管捆绑包 下载 Windows 版本的 ASP.NET Core 托管捆绑包（Hosting Bundle），对应「ASP.NET Core 运行时 8.0.22」板块下 Windows 行的「Hosting Bundle」链接...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"IIS 部署 ASP.NET Core WebAPI 指南\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-12-10T10:37:53.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"XJ\\",\\"url\\":\\"https://kadobao.github.io/study_blog/acrticle/\\"}]}"],["meta",{"property":"og:url","content":"https://mister-hope.github.io/study_blog/acrticle/%E4%B8%80%E4%BA%9B%E9%9A%8F%E8%AE%B0/IIS%20%E9%83%A8%E7%BD%B2%20ASP.NET%20Core%20WebAPI%20%E6%8C%87%E5%8D%97.html"}],["meta",{"property":"og:site_name","content":"个人学习记录博客"}],["meta",{"property":"og:title","content":"IIS 部署 ASP.NET Core WebAPI 指南"}],["meta",{"property":"og:description","content":"IIS 部署 ASP.NET Core Web API 指南 第一步：安装必要组件 1.1 下载 ASP.NET Core 托管捆绑包 下载 Windows 版本的 ASP.NET Core 托管捆绑包（Hosting Bundle），对应「ASP.NET Core 运行时 8.0.22」板块下 Windows 行的「Hosting Bundle」链接..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-12-10T10:37:53.000Z"}],["meta",{"property":"article:tag","content":"WebAPI"}],["meta",{"property":"article:tag","content":"IIS"}],["meta",{"property":"article:modified_time","content":"2025-12-10T10:37:53.000Z"}]]},"git":{"createdTime":1765363073000,"updatedTime":1765363073000,"contributors":[{"name":"XJ","username":"XJ","email":"XJ@qq.com","commits":1,"url":"https://github.com/XJ"}]},"readingTime":{"minutes":4.68,"words":1405},"filePathRelative":"acrticle/一些随记/IIS 部署 ASP.NET Core WebAPI 指南.md","excerpt":"\\n<h2>第一步：安装必要组件</h2>\\n<h3><a class=\\"header-anchor\\" href=\\"#_1-1-下载-asp-net-core-托管捆绑包\\"><span>1.1 下载 </span></a><a href=\\"http://ASP.NET\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">ASP.NET</a> Core 托管捆绑包</h3>\\n<p>下载 Windows 版本的 <a href=\\"http://ASP.NET\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">ASP.NET</a> Core 托管捆绑包（Hosting Bundle），对应「<a href=\\"http://ASP.NET\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">ASP.NET</a> Core 运行时 8.0.22」板块下 Windows 行的「Hosting Bundle」链接：</p>","autoDesc":true}');export{h as comp,p as data};
