---
title: 解决自定义标题栏导致最大化覆盖任务栏的问题
icon: code
order: 21
category:
  - C#学习
tag:
  - WPF
  - 任务栏
---

# 解决自定义标题栏导致最大化覆盖任务栏的问题

## 问题描述

在WPF中，当我们设置了 `WindowStyle="None"` 来自定义标题栏后，最大化窗口时会导致任务栏被覆盖，影响用户体验。

## 解决方案

要解决这个问题，我们只需要获取系统定义的**最大化窗口的标准尺寸（不包括任务栏）**，然后使用这个定义来设置WPF的 `MaxWidth` 和 `MaxHeight` 属性。

### 核心代码

```xml
MaxWidth="{StaticResource {x:Static SystemParameters.MaximizedPrimaryScreenWidthKey}}"
MaxHeight="{StaticResource {x:Static SystemParameters.MaximizedPrimaryScreenHeightKey}}"
```

## 完整示例

下面是一个完整的Window XAML示例，展示了如何应用这个解决方案：

```xml
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="clr-namespace:WPF的MVVM模式的Prism框架"
    xmlns:prism="http://prismlibrary.com/"
    xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes" 
    x:Class="WPF的MVVM模式的Prism框架.Views.MainWindow"
    Title="Prism - 导航栏"
    Width="1200"
    Height="800"
    AllowsTransparency="True"
    WindowState="Normal"
    WindowStyle="None"
    Background="{x:Null}"
    MinHeight="800" 
    MinWidth="1200" 
    MaxWidth="{StaticResource {x:Static SystemParameters.MaximizedPrimaryScreenWidthKey}}"
    MaxHeight="{StaticResource {x:Static SystemParameters.MaximizedPrimaryScreenHeightKey}}"    
    prism:ViewModelLocator.AutoWireViewModel="True">
    <!-- 窗口内容 -->
</Window>
```

## 效果展示

应用此解决方案后，窗口最大化时将不再覆盖任务栏，保持了系统的正常布局：

![解决任务栏被覆盖问题](/assets/images/解决任务栏被覆盖问题.png)

## 关键点说明

1. `SystemParameters.MaximizedPrimaryScreenWidthKey`：获取系统定义的最大化窗口宽度（不包括任务栏）
2. `SystemParameters.MaximizedPrimaryScreenHeightKey`：获取系统定义的最大化窗口高度（不包括任务栏）
3. 使用 `StaticResource` 绑定这些系统参数，确保窗口最大化时正确适应屏幕尺寸

这种方法简单有效，不需要复杂的代码逻辑，只需要在XAML中添加两个属性绑定即可解决问题。
